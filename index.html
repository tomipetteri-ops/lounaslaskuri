<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Lounaslaskuri</title>
    <style>
        /* Dynaaminen skaalaus E-ink-näytölle */
        body {
            background-color: white;
            color: black;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            text-align: center;
            overflow: hidden;
        }

        .henkilo { 
            margin-bottom: 3vh; /* Väli suhteessa näytön korkeuteen */
        }

        .label { 
            /* Skaalautuu välillä 14px - 24px näytön leveyden mukaan */
            font-size: clamp(0.9rem, 2.5vw, 1.5rem); 
            text-transform: uppercase; 
            font-weight: bold;
            letter-spacing: 0.1em;
        }

        .euro { 
            /* Skaalautuu välillä 32px - 80px */
            font-size: clamp(2rem, 8vw, 5rem); 
            font-weight: bold; 
            line-height: 1.1;
        }

        .yhteensa-kuukausi { 
            border-top: 4px solid black; 
            padding-top: 2vh; 
            width: 90%; 
        }

        .kaikki-yhteensa { 
            border-top: 8px double black; 
            padding-top: 2vh; 
            margin-top: 2vh; 
            width: 90%; 
        }

        .kaikki-yhteensa .euro { 
            /* Vuosisäästö on kaikista suurin numero */
            font-size: clamp(3rem, 12vw, 8rem); 
        }

        /* Pieni infoteksti alareunassa */
        #pvm-info {
            position: fixed;
            bottom: 10px;
            font-size: 0.8rem;
            opacity: 0.5;
        }
    </style>
</head>
<body onclick="document.documentElement.requestFullscreen()">

    <div class="henkilo">
        <div class="label">Paula (tässä kuussa)</div>
        <div id="paula-saasto" class="euro">0.00 €</div>
    </div>

    <div class="henkilo">
        <div class="label">Tomi (tässä kuussa)</div>
        <div id="tomi-saasto" class="euro">0.00 €</div>
    </div>

    <div class="yhteensa-kuukausi">
        <div id="kuukausi-otsikko" class="label">Yhteensä</div>
        <div id="yhteensa-saasto" class="euro">0.00 €</div>
    </div>

    <div class="kaikki-yhteensa">
        <div class="label">Säästöt 2026</div>
        <div id="kaikki-saasto" class="euro">0.00 €</div>
    </div>

    <div id="pvm-info"></div>

    <script>
        // Säästötiedot - Voit muuttaa näitä tarvittaessa
        const paulaHistory = [{ alkaen: "2026-01-01", summa: 410 }];
        const tomiHistory = [{ alkaen: "2026-01-01", summa: 870 }];

        const months = ["Tammikuussa", "Helmikuussa", "Maaliskuussa", "Huhtikuussa", "Toukokuussa", "Kesäkuussa", "Heinäkuussa", "Elokuussa", "Syyskuussa", "Lokakuussa", "Marraskuussa", "Joulukuussa"];
        
        function getDaysInMonth(date) { return new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate(); }

        function calculateSavings(history, start, end) {
            let total = 0;
            for (let i = 0; i < history.length; i++) {
                const entry = history[i];
                const entryStart = new Date(entry.alkaen).getTime();
                let entryEnd = (i + 1 < history.length) ? new Date(history[i+1].alkaen).getTime() : end;
                const activeStart = Math.max(entryStart, start);
                const activeEnd = Math.min(entryEnd, end);
                if (activeEnd > activeStart) {
                    const seconds = (activeEnd - activeStart) / 1000;
                    const days = getDaysInMonth(new Date(activeStart));
                    total += seconds * (entry.summa / (days * 24 * 60 * 60));
                }
            }
            return total;
        }

        function update() {
            const now = new Date();
            const nowMs = now.getTime();
            const monthStartMs = new Date(now.getFullYear(), now.getMonth(), 1).getTime();
            const yearStartMs = new Date(2026, 0, 1).getTime();

            const pM = calculateSavings(paulaHistory, monthStartMs, nowMs);
            const tM = calculateSavings(tomiHistory, monthStartMs, nowMs);
            const pY = calculateSavings(paulaHistory, yearStartMs, nowMs);
            const tY = calculateSavings(tomiHistory, yearStartMs, nowMs);

            document.getElementById("paula-saasto").innerText = pM.toFixed(2) + " €";
            document.getElementById("tomi-saasto").innerText = tM.toFixed(2) + " €";
            document.getElementById("yhteensa-saasto").innerText = (pM + tM).toFixed(2) + " €";
            document.getElementById("kaikki-saasto").innerText = (pY + tY).toFixed(2) + " €";
            document.getElementById("kuukausi-otsikko").innerText = "Yhteensä " + months[now.getMonth()];
            
            // Päivitetään pikkuteksti
            document.getElementById("pvm-info").innerText = now.toLocaleString('fi-FI');
        }

        setInterval(update, 60000);
        update();
    </script>
</body>
</html>
